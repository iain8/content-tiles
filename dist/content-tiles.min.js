!function(){function getAttrAsInt(el,attr){return parseInt(el.getAttribute(attr),10)}function getAttrAsFloat(el,attr){return parseFloat(el.getAttribute(attr))}var ContentTiles={spacing:0,containerClass:"content-tiles",innerClasses:[],itemClass:"content-item",rowClass:"content-row",rowHeight:400,init:function(options){var opts=options||{};this.spacing=opts.spacing||this.spacing,this.containerClass=opts.containerClass||this.containerClass,this.innerClasses=opts.innerClasses||this.innerClasses,this.itemClass=opts.itemClass||this.itemClass,this.rowHeight=opts.rowHeight||this.rowHeight;var containers=document.getElementsByClassName(this.containerClass);if(0!==containers.length)for(var i=0;i<containers.length;++i){for(var container=containers[i],data=[],maxWidth=container.offsetWidth,rowHeight=getAttrAsInt(container,"data-row-height")||this.rowHeight,spacing=getAttrAsInt(container,"data-spacing")||this.spacing,content=container.getElementsByClassName("content-item"),dataLength=content.length,j=0;j<dataLength;++j){var width=getAttrAsInt(content[j],"data-width"),height=getAttrAsInt(content[j],"data-height");content[j].setAttribute("data-width",width*(rowHeight/height)),content[j].setAttribute("data-height",rowHeight),data.push(content[j])}var rows=this.populate(container,data,maxWidth,spacing);this.render(container,rows)}},populate:function(container,data,maxWidth,spacing){for(var rows=this.buildRows(data,maxWidth),rowCount=rows.length,i=0;i<rowCount;++i){rows[i]=this.fitImagesInRow(rows[i],maxWidth);var difference=maxWidth-this.getTotalWidth(rows[i]),imageCount=rows[i].length;if(imageCount>1&&difference<spacing){for(var offset=difference/imageCount,rowsCount=rows[i].length,j=0;j<rowsCount;++j)rows[i][j].setAttribute("data-width",getAttrAsFloat(rows[i][j],"data-width")+offset);var lastEl=rows[i][imageCount-1];lastEl.setAttribute("data-width",getAttrAsFloat(lastEl,"data-width")+(maxWidth-this.getTotalWidth(rows[i])))}}return rows},buildRows:function(data,maxWidth){for(var currentRow=0,currentWidth=0,rows=[],dataLength=data.length,i=0;i<dataLength;++i)currentWidth>=maxWidth&&(++currentRow,currentWidth=0),rows[currentRow]||(rows[currentRow]=[]),rows[currentRow].push(data[i]),currentWidth+=getAttrAsFloat(data[i],"data-width");return rows},fitImagesInRow:function(row,maxWidth){for(var rowCount=row.length;this.getTotalWidth(row)>maxWidth;)for(var i=0;i<rowCount;++i)row[i]=this.shrinkElement(row[i]);return row},getTotalWidth:function(row){for(var width=0,rowLength=row.length,i=0;i<rowLength;++i)width+=getAttrAsFloat(row[i],"data-width");return width+(row.length-1)*this.spacing},shrinkElement:function(el){var height=getAttrAsFloat(el,"data-height"),width=getAttrAsFloat(el,"data-width");if(height>1){var newHeight=height-1;el.setAttribute("data-width",width*(newHeight/height)),el.setAttribute("data-height",newHeight)}else el.setAttribute("data-width",0),el.setAttribute("data-height",0);return el},render:function(container,rows){Array.prototype.forEach.call(container.getElementsByClassName(this.itemClass),function(el){el.parentNode.removeChild(el)});for(var rowsLength=rows.length,fragment=document.createDocumentFragment(),i=0;i<rowsLength;++i){var newRow=document.createElement("div");newRow.classList?newRow.classList.add(this.rowClass):newRow.className=this.rowClass;for(var rowLength=rows[i].length,j=0;j<rowLength;++j){var el=rows[i][j],height=getAttrAsInt(el,"data-height")+"px",width=getAttrAsInt(el,"data-width")+"px";el.style.width=width,el.style.height=height;for(var innerClassesLength=this.innerClasses.length,k=0;k<innerClassesLength;++k)el.getElementsByClassName(this.innerClasses[k])[0].style.height=height;newRow.appendChild(el)}fragment.appendChild(newRow)}container.appendChild(fragment)}};"undefined"!=typeof module&&void 0!==module.exports?module.exports=ContentTiles:"function"==typeof define&&define.amd?define([],function(){return ContentTiles}):window.ContentTiles=ContentTiles}();